%h2
  = t(:purchases)
.row
  .medium-9.columns
    %div
      %table.table.table-striped.table-bordered.table-condensed
        %thead
          %tr
            %th= sort_link @q, :name
            %th= sort_link @q, :ordered_on
            %th= sort_link @q, :received_on
            %th=t  "basket"
            %th{:colspan => 2}= @purchase_scope.count.to_s + " " +  t(:purchases)
        %tbody
          - @purchases.each do |purchase|
            %tr{:class => "line-#{cycle("1","2")}"}
              %td=purchase.name
              %td=purchase.ordered_on
              %td=purchase.received_on
              %td
                - if not purchase.basket.nil? then
                  = link_to basket_path(purchase.basket) do
                    = "#{purchase.basket.items.count}  #{t(:items)} /  #{purchase.basket.total_price} â‚¬"
              %td= link_to t(:show) , purchase_path(purchase), :title => t(:show)
              %td= link_to t(:destroy) ,purchase_path(purchase), :data => { :confirm => t(:are_you_sure)}, :method => :delete, :title => t(:destroy)
      .btn-toolbar
        .btn-group
          = paginate @purchases
  .medium-3.columns
    = search_form_for @q, :url => search_purchases_path, :html => { :class => "well well-small" }, :method => :post do |f|
      = f.facet_for("name" , :label => t(:name))
      = f.label t(:ordered_on) + " " + t(:between)
      = f.date_field :ordered_on_gt
      = f.date_field :ordered_on_lt
      = f.label t(:received_on) + " "  +t(:between)
      = f.date_field :received_on_gt
      = f.date_field :received_on_lt
      = f.submit t(:filter), :class => "submit-button"
      = link_to  t(:cancel), purchases_path, :class => "admin-button"
